# Screen Overview

Scheduly の React 版 UI は現状、次の 2 画面で構成されます。ここでは役割と主要要素、画面間の関係を簡潔に整理します。すべて `src/frontend/` に JSX 実装があり、`public/*.html` からエントリーポイントとして読み込まれます。

## 管理画面（Admin Console）

- **エントリ**: `src/frontend/admin.jsx` / 初期表示: `public/index.html`（共有トークン発行後は `/a/{token}` へリダイレクト）
- **目的**: プロジェクト情報の編集、候補日（イベント）管理、ICS のインポート／エクスポート、共有 URL の生成など主催者向け操作をまとめる。
- **主要 UI**:
  - プロジェクト情報フォーム（タイトル・説明）
  - 候補日カード（確定／仮／取消しラベル、日時、場所、メモ）
  - ICS 個別／一括エクスポート、ICS インポートプレビュー
  - プロジェクト JSON のエクスポート／インポート
  - 共有 URL（管理者／参加者）生成と表示
- **データ入出力**:
  - `project-service` / `schedule-service` を通じて `project-store` の状態を更新。ICS インポートは `scheduleService.replaceCandidatesFromImport` を通して反映。
  - エクスポート時は `schedule-service` が最新の候補 state から ICS を生成。
  - 共有 URL の生成はオンメモリだが、発行後は `/a/{token}` にリダイレクトして管理画面を再表示する。

## 参加者 UI（Participant Dashboard）

- **エントリ**: `src/frontend/user.jsx` / 初期表示: `public/user.html`（共有トークン利用時は `/p/{token}` へリダイレクト）
- **目的**: 参加者・主催者の双方が全候補の概要と回答サマリーを確認し、出欠状況を把握・更新できるようにする。
- **主要 UI**:
  - 「日程ごと」「参加者ごと」のタブ切り替え
  - 各候補日カード：日付・時間・場所・説明・回答サマリー（○△×）
  - 個別参加者の回答一覧（参加者タブ）とカード内インライン編集（○△× とコメント）
- **データ入出力**:
  - `summary-service` が `project-store` の派生データを生成し、日程／参加者ごとのサマリーを提供。
  - インライン編集で回答を更新すると `response-service` から `tally-service` が再集計し、タブ表示がリアルタイム更新される。

## 参加者回答管理ビュー（計画中）

- **位置付け**: `user.jsx`（参加者一覧画面）を拡張し、管理者が回答状況を俯瞰・編集できるビューを追加する構想。
- **目的**:
  - 参加者ごとの回答を検索・フィルタリングし、候補別の賛否を素早く把握する。
  - 確定候補を決める際の判断材料として、マトリクス集計や詳細カードを提供する。
  - 必要に応じて管理者が回答を修正したりコメントを追記したりできる導線を用意する。
- **レイアウト案**:
  1. 上部コントロールでプロジェクト概要・フィルター・検索を配置。
  2. メイン領域に「参加者 × 候補」のマトリクスと、クリック時に開く詳細カードを表示。
  3. サイドパネルに候補ごとの集計（○△×の数、コメント有無、確定操作）を置く。モバイルでは縦積みにし、マトリクスを横スクロール対応にする。
- **データモデルのメモ**:
  - `Participant`, `Response`, `Slot`（候補）を組み合わせてマトリクスを構成する。`Response.mark` は `'o' | 'd' | 'x' | null`。
  - 現在は `project-store` 上に派生データ（サマリー・タリー）を保持している。将来的に REST API で永続化する際も同じモデルを提供する想定。
- **今後の実装ステップ**:
  1. React state を活用した UI モックを作成し、既存データを可視化。
  2. 管理者が回答を修正できるアクションを追加。
  3. ICS 連携や通知フローと連動させる。
  4. サーバー/API 実装時に CRUD と認証を整備。
- **補足**:
  - 参加者が自己編集できる前提では、履歴管理やアラートも必要になる可能性がある。
  - 大規模プロジェクト向けに仮想スクロールやページネーションなどのパフォーマンス対策を検討する。

## 画面間の関係

1. **管理画面**で候補やプロジェクト情報を編集し、参加者向け URL を発行する。
2. 参加者は共有された **参加者 UI** で概要を確認し、カード内のインライン編集で自身の回答（○△×／コメント）を更新する。
3. 完成形では、回答結果を **管理画面**が集計し、候補ごとの出欠が更新される想定。

現状は `project-store` を中心とした in-memory データレイヤーで 2 画面が同期しており、共有トークンや URL パラメータを経由して状態を切り替える。今後サーバー/API を導入する際は、このデータモデル（Project / Slot / Participant / Response）を REST などに移行し、同じ参照構造を維持することが想定される。
